{% extends "base.html" %} {% block content %}

<div class="grid grid-cols-1 sm:px-5 md:px-10 lg:grid-cols-2 lg:px-20 xl:px-40 gap-10">
  <div class="mt-10 bg-gray-50 px-6 sm:px-8 md:px-16 lg:mt-0">
    <h1 class="text-2xl sm:text-3xl font-bold">Billing Details</h1>
    
    <div>
      <label for="name" class="mt-4 mb-2 block text-lg sm:text-xl font-bold">Full Name</label>
      <input
        type="text"
        id="name"
        name="name"
        class="w-full rounded-md border border-gray-200 px-4 py-3 text-base sm:text-lg shadow-sm outline-none focus:border-blue-500 focus:ring-blue-500"
        placeholder="Full Name"
      />
      
      <label for="contact" class="mt-4 mb-2 block text-lg sm:text-xl font-bold">Phone Number/Email</label>
      <input
        type="text"
        id="contact"
        name="contact"
        class="w-full rounded-md border border-gray-200 px-4 py-3 text-base sm:text-lg shadow-sm outline-none focus:border-blue-500 focus:ring-blue-500"
        placeholder="Phone Number/Email"
      />

      <label for="address" class="mt-4 mb-2 block text-lg sm:text-xl font-bold">Full Address</label>
      <input
        type="text"
        id="address"
        name="address"
        class="w-full rounded-md border border-gray-200 px-4 py-3 text-base sm:text-lg shadow-sm outline-none focus:border-blue-500 focus:ring-blue-500"
        placeholder="Full Address"
      />

      <label for="country" class="mt-4 mb-2 block text-lg sm:text-xl font-bold">Country</label>
      <input
        type="text"
        id="country"
        name="country"
        class="w-full rounded-md border border-gray-200 px-4 py-3 text-base sm:text-lg shadow-sm outline-none focus:border-blue-500 focus:ring-blue-500"
        placeholder="Country"
      />
    </div>

    <h1 class="text-2xl sm:text-3xl font-bold mt-10">Payment Option</h1>
    {% comment %} <div class="flex items-center mt-6">
      <input
        type="radio"
        id="paymentOption"
        name="inline-radio-group"
        class="w-4 h-4 text-black"
      />
      <a 
        class="ms-5 text-xl font-medium text-black" 
        href="javascript:void(0);" 
        onclick="toggleForm()">Credit and Debit Cards</a>
        <svg class='w-5 h-5 mx-3' xmlns="http://www.w3.org/2000/svg" fill="currentColor" class="bi bi-credit-card-fill" viewBox="0 0 16 16"> <path d="M0 4a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v1H0V4zm0 3v5a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7H0zm3 2h1a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1z"/> </svg>
    </div> {% endcomment %}
    <div onclick="toggleForm()" class="flex items-center mt-6">
      <input type="radio" id="paymentOption" name="inline-radio-group" class="w-4 h-4 text-blue-600" />
      <label onclick="toggleForm()" for="paymentOption" class="ml-4 text-lg sm:text-xl font-medium text-black">Credit and Debit Cards</label>
      <svg class="w-5 h-5 ml-3" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 16 16">
        <path d="M0 4a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v1H0V4zm0 3v5a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7H0zm3 2h1a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1z"/>
      </svg>
    </div>

    <div id="paymentForm" class="flex flex-col gap-4 mt-4 hidden">
      <div>
        <label class="block mb-2 text-base sm:text-lg">Card Number</label>
        <input type="text" class="w-full bg-gray-50 border border-gray-300 text-gray-900 rounded-lg p-4 placeholder:text-lg sm:placeholder:text-xl" placeholder="1234 5678 9012 3456" />
      </div>

      <div class="flex gap-5">
        <div>
          <label class="block mb-2 text-base sm:text-lg">Expiration Date</label>
          <input type="text" class="w-full bg-gray-50 border border-gray-300 text-gray-900 rounded-lg p-4 placeholder:text-lg sm:placeholder:text-xl" placeholder="MM/YY" />
        </div>
        
        <div>
          <label class="block mb-2 text-base sm:text-lg">Security Code</label>
          <input type="text" class="w-full bg-gray-50 border border-gray-300 text-gray-900 rounded-lg p-4 placeholder:text-lg sm:placeholder:text-xl" placeholder="123" />
        </div>
      </div>

      <div>
        <label class="block mb-2 text-base sm:text-lg">Cardholder's Name</label>
        <input type="text" class="w-full bg-gray-50 border border-gray-300 text-gray-900 rounded-lg p-4 placeholder:text-lg sm:placeholder:text-xl" placeholder="As Written on Card" />
      </div>
    </div>

    <div class="flex items-center mt-5">
      <input type="radio" id="paypal" name="inline-radio-group" class="w-4 h-4 text-blue-600" />
      <label for="paypal" class="ml-4 text-lg sm:text-xl font-medium text-black">Paypal</label>
    </div>
  </div>

  <div class="px-6 sm:px-8 md:px-16">
    <p class="text-2xl sm:text-3xl font-bold">Order Summary</p>

    <div class="mt-8 space-y-4 rounded-lg border bg-white p-4 sm:p-6">
      {% for item_id, item in cart.items %}
      <div 
    id="item-{{ item_id }}" 
    class="flex flex-row items-center justify-between rounded-lg bg-gray-100 space-x-8"
>

    <button class="remove text-red-500 hover:text-red-700 text-2xl sm:text-xl md:text-2xl lg:text-3xl mr-2" data-id="{{ item_id }}">Ã—</button>

    <img 
        class="h-10 w-16 sm:h-12 sm:w-20 md:h-14 md:w-20 rounded-md object-cover" 
        src="{{ item.image }}" 
        alt="{{ item.title }}" 
    />

    <div class="flex-grow flex flex-col">
        <p class="text-xs sm:text-sm md:text-lg lg:text-xl font-bold">{{ item.title }}</p>
        <p class="text-lg sm:text-lg md:text-xl font-bold">${{ item.price }}</p>
    </div>
</div>

      {% endfor %}
    </div>
      
      <div class="mt-5">
        <div class="flex justify-between items-center">
          <p class="font-medium text-lg sm:text-xl text-gray-700">Sub Total</p>
          <p class="font-bold text-lg sm:text-xl text-black">${{ total_price|floatformat:2 }}</p>
        </div>
        
        <div class="flex justify-between items-center">
          <p class="font-medium text-lg sm:text-xl text-gray-700">Free Shipping</p>
          <p id="total-price" class="font-bold text-lg sm:text-xl text-black">Total Price: ${{ total_price }}</p>
        </div>
      </div>

      <div class="mt-8">
        <button class="w-full bg-black text-white text-lg sm:text-xl font-bold py-4 rounded hover:bg-red-600">Confirm Order</button>
      </div>
    </div>
  </div>
</div>


<script>
  document.addEventListener("DOMContentLoaded", function () {
    document.querySelectorAll(".remove").forEach((button) => {
      button.addEventListener("click", function () {
        const itemId = this.getAttribute("data-id");
        fetch("{% url 'cart' %}", {
          method: "POST",
          headers: {
            "X-CSRFToken": "{{ csrf_token }}",
            "Content-Type": "application/json",
          },
          body: JSON.stringify({
            item_id: itemId,
            action: "delete",
          }),
        })
          .then((response) => response.json())
          .then((data) => {
            if (!data.error) {
              // Refresh the page to reflect the updated cart
              window.location.reload();
            } else {
              console.error(data.error); // Log the error for debugging
            }
          });
      });
    });
  });
</script>
<script>
  function toggleForm() {
    const form = document.getElementById("paymentForm");
    form.classList.toggle("hidden");
  }
</script>

{% endblock %}
